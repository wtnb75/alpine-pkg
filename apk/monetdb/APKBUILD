# Contributor: Watanabe Takashi <wtnb75@gmail.com>
# Maintainer:
pkgname=monetdb
pkgver=11.41.11
pkgrel=0
pkgdesc="column store db"
url="https://monetdb.org/"
arch="all"
license="MPL-2.0"
depends=""
makedepends="cmake bison python3-dev linux-headers"
install=""
subpackages="${pkgname}-doc py3-$pkgname:py3 ${pkgname}-dev"
source="https://www.monetdb.org/downloads/sources/Latest/MonetDB-${pkgver}.tar.bz2 alpine-build.patch"
builddir="${srcdir}/MonetDB-${pkgver}"

build() {
	cd "$builddir"
	mkdir build
	cd build
	export CC=$(which gcc)
	export CXX=$(which g++)
	cmake -DCMAKE_INSTALL_PREFIX=/usr -DCMAKE_INSTALL_LOCALSTATEDIR=/var -DCMAKE_INSTALL_LIBDIR=/usr/lib ..
	make
}

check() {
	:
}

package() {
	cd "$builddir"/build
	make install DESTDIR=${pkgdir}
}

py3() {
	pkgdesc="$pkgname python binding"
	depends="python3"
	mkdir -p "$subpkgdir"/usr/lib
	mv "$pkgdir"/usr/lib/python* "$subpkgdir"/usr/lib
}

sha512sums="
afedfb83fc4c7f9da13f30b2b3ffb769c1ba7995aecbe2a0294e10a2c70e80cff3a613182291211179ecf6131b50307f7b194e96e5b48a66423bc046c1ec0bf2  MonetDB-11.41.11.tar.bz2
0346d80535c87be99dee497da789bb75b437ffb4991a69357e41cf221254a786798607f88ec790f9996577b3abb38d1be2ee02fd481c42775d164472bfa1fdba  alpine-build.patch
"
