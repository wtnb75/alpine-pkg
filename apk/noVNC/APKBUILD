# Contributor: Watanabe Takashi <wtnb75@gmail.com>
# Maintainer:
pkgname=noVNC
pkgver=1.3.0
_websockify_ver=0.9.0
pkgrel=0
pkgdesc="VNC client web application"
url="https://github.com/novnc/noVNC"
arch="all"
license="MPL-2.0"
depends="python3 procps bash"
makedepends=""
install=""
subpackages=""
source="${pkgname}-${pkgver}.tar.gz::https://github.com/novnc/noVNC/archive/refs/tags/v${pkgver}.tar.gz websockify-${_websockify_ver}.tar.gz::https://github.com/novnc/websockify/archive/refs/tags/v${_websockify_ver}.tar.gz"
builddir="${srcdir}/${pkgname}-${pkgver}"

build() {
	cd "$builddir"
	mv ../websockify-${_websockify_ver} utils/websockify
	sed -i -e 's,python ,python3 ,g;' utils/websockify/run
}

check() {
	:
}

package() {
	cd "$builddir"
	mkdir -p ${pkgdir}/usr/noVNC
	mkdir -p ${pkgdir}/usr/bin
	cp -r ./ ${pkgdir}/usr/noVNC/
	ln -s ../noVNC/utils/launch.sh ${pkgdir}/usr/bin/noVNC
}

sha512sums="
2c9eb019bd9c86a0ffb716eba06e8f05bc522c37561e0acc7f88a66188c617ebc54f4cc9220897c241280ba2ed5919a2050a94eeb3da2c030bde43af0bd92c51  noVNC-1.3.0.tar.gz
d2251f653a40dc6dca0e5541845565d968c60be96a20a9b70b0305c4b7578f7fe205d4b98a94bb77d7c9383a396833af90fe92a6ade7e1a6f2d9bf8513d372c8  websockify-0.9.0.tar.gz
"
